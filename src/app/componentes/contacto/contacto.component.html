<div class="container mt-5">
  <div class="row gx-5">
    <div class="col-md-6">
      <h2>
        <i class="material-icons align-middle">contact_mail</i>
        Contáctanos
      </h2>
      <hr>

      <!-- Información de contacto -->
      <p>
        <i class="material-icons align-middle">phone</i>
        <strong>Teléfono:</strong>
        <a href="tel:+34123456789">+34 645 13 11 03</a>
      </p>
      <p>
        <i class="material-icons align-middle">location_on</i>
        <strong>Dirección:</strong>
        Av. Cervantes, 5, Nº 5 BAJO, 14850 Baena, Córdoba
      </p>
      <p>
        <i class="material-icons align-middle">camera_alt</i>
        <strong>Instagram:</strong>
        <a href="https://www.instagram.com/mundonomadaa" target="_blank">&#64;mundonomadaa</a>
      </p>

      <hr>
      <h4>Formulario de Contacto</h4>
      
      <!-- Mensaje de éxito -->
      <div *ngIf="mensajeEnviado" class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="material-icons align-middle">check_circle</i>
        Tu mensaje ha sido enviado correctamente. Nos pondremos en contacto contigo lo antes posible.
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" (click)="mensajeEnviado = false"></button>
      </div>
      
      <!-- Mensaje de error -->
      <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="material-icons align-middle">error</i>
        <span *ngIf="errorMessage">{{ errorMessage }}</span>
        <span *ngIf="!errorMessage">Ha ocurrido un error al enviar el mensaje. Por favor, inténtalo de nuevo más tarde.</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" (click)="error = false"></button>
      </div>
      
      <form [formGroup]="contactForm" (ngSubmit)="enviarMensaje()" id="contact-form">
        <!-- Nombre -->
        <div class="mb-3">
          <label for="nombre" class="form-label">Nombre</label>
          <div class="input-group">
            <input 
              type="text" 
              class="form-control" 
              id="nombre" 
              name="from_name"
              formControlName="nombre" 
              placeholder="Tu nombre" 
              [ngClass]="{'is-invalid': getCampoInvalido('nombre')}" 
            />
          </div>
          <div *ngIf="getCampoInvalido('nombre')" class="text-danger small mt-1">
            <div *ngIf="contactForm.get('nombre')?.errors?.['required']">El nombre es requerido.</div>
            <div *ngIf="contactForm.get('nombre')?.errors?.['minlength']">El nombre debe tener al menos 2 caracteres.</div>
          </div>
        </div>

        <!-- Correo Electrónico -->
        <div class="mb-3">
          <label for="email" class="form-label">Correo Electrónico</label>
          <div class="input-group">
            <input 
              type="email" 
              class="form-control" 
              id="email" 
              name="reply_to"
              formControlName="email" 
              placeholder="nombre@ejemplo.com" 
              [ngClass]="{'is-invalid': getCampoInvalido('email')}" 
            />
          </div>
          <div *ngIf="getCampoInvalido('email')" class="text-danger small mt-1">
            <div *ngIf="contactForm.get('email')?.errors?.['required']">El correo electrónico es requerido.</div>
            <div *ngIf="contactForm.get('email')?.errors?.['email']">Por favor, ingresa un correo electrónico válido.</div>
          </div>
        </div>

        <!-- Mensaje -->
        <div class="mb-3">
          <label for="mensaje" class="form-label">Mensaje</label>
          <div class="input-group">
            <textarea 
              class="form-control" 
              id="mensaje" 
              name="message"
              formControlName="mensaje" 
              placeholder="Escribe tu mensaje" 
              style="height: 150px; resize: none;"
              [ngClass]="{'is-invalid': getCampoInvalido('mensaje')}"
            ></textarea>
          </div>
          <div *ngIf="getCampoInvalido('mensaje')" class="text-danger small mt-1">
            <div *ngIf="contactForm.get('mensaje')?.errors?.['required']">El mensaje es requerido.</div>
            <div *ngIf="contactForm.get('mensaje')?.errors?.['minlength']">El mensaje debe tener al menos 10 caracteres.</div>
          </div>
        </div>

        <button 
          type="submit" 
          class="btn btn-primary btn-lg w-100" 
          [disabled]="enviando"
        >
          <span *ngIf="!enviando">Enviar Mensaje</span>
          <span *ngIf="enviando">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Enviando...
          </span>
        </button>
      </form>
    </div>

    <!-- Sección Derecha: Ubicación (Mapa de Google) -->
    <div class="col-md-6">
      <h4>Ubicación</h4>
      <div class="ratio ratio-16x9 shadow-sm">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d1222.1639907177769!2d-4.321207854788916!3d37.6176222012303!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd6da147624035cb%3A0x8e1d04cbaafeb11a!2sMundo%20Nomada!5e1!3m2!1ses!2ses!4v1740398554464!5m2!1ses!2ses"
          width="800" height="600" style="border:0;" allowfullscreen="" loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
    </div>
  </div>
</div>